<aura:component Controller="TransactionController" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction,lightning:actionOverride" access="global">
    
    <aura:attribute name="cutoffCounter" type="integer" default="0" />
    <!-- For Client Consonent File Attachment Start -->
    <!-- 'parentId' Aura Attribute for store the Id for Parent Record where we are attach our file -->  
    <aura:attribute name="parentId" type="Id"/>
    <!-- 'showLoadingSpinner' attribute for show/hide the uploading image and msg in aura:if-->
    <aura:attribute name="showLoadingSpinner" type="boolean" default="false" />
    <!-- 'fileName' attribute for display the selected file name -->  
    <aura:attribute name="fileName" type="String" default="No File Selected.." />
    <!-- Lightning Input with file type and on file change call the 'handleFilesChange' controller -->
    <aura:attribute name="attachmentName" type="String" default=""/>
    <!-- For Client Consonent File Attachment Start -->
    
    <!--lightning help text for input field-->
    <aura:attribute name="holdingInformation" type="String" default="Please enter value"/>
    <aura:attribute name="clientHoldingType" type="String" default="Please enter value"/>
    
    <!-- disable preview screen fields -->
    <aura:attribute name="isDisabled" type="Boolean" default="true" />
    
    
    <aura:attribute name="orderEntry" type="Order_Entry__c" 
                    default="{ 'sobjectType': 'Order_Entry__c' }"/>	
    
    <aura:attribute name="filteredFamilyList" type="String[]" />
    <aura:attribute name="filteredClientList" type="String[]" />
    <aura:attribute name="filteredClientAccountList" type="String[]" />
    <aura:attribute name="filteredClientAssetList" type="String[]" />
    <aura:attribute name="filteredClientAssetListRedemption" type="String[]" />
    <aura:attribute name="filteredInstruments" type="String[]" />
    <aura:attribute name="folioList" type="String[]" />
    <aura:attribute name="uccList" type="String[]" />
    <aura:attribute name="folioListPurchase" type="String[]" />
    <aura:attribute name="amcList" type="String[]" />
    <aura:attribute name="schemeList" type="String[]" />
    <aura:attribute name="selectedFamilyRecord" type="sObject" default="{}"/>
    <aura:attribute name="selectedClientRecord" type="sObject" default="{}"/>
    <aura:attribute name="selectedClientAccountRecord" type="sObject" default="{}"/>
    <aura:attribute name="selectedProduct" type="sObject" default="{}"/>
    <aura:attribute name="selectedAMCName" type="sObject" default="{}"/>
    <aura:attribute name="selectedScheme" type="sObject" default="{}"/>
    <aura:attribute name="selectedAMCName1" type="sObject" default="{}"/>
    <aura:attribute name="selectedSchemeObj" type="sObject" default="{}"/>
    <aura:attribute name="selectedFromSchemeObj" type="sObject" default="{}"/>
    <aura:attribute name="selectedToSchemeObj" type="sObject" default="{}"/>
    <aura:attribute name="selectedClientCode" type="sObject" default="{}"/>
    <aura:attribute name="selectedFolio" type="sObject" default="{}"/>
    <aura:attribute name="selectedClientPAN" type="String" />
    <aura:attribute name="selectedClientAccountId" type="String" />
    <aura:attribute name="selectedClientAccountIdAttr" type="String" />
    <aura:attribute name="selectedClientAssetRecord" type="sObject" default="{}"/>
    <aura:attribute name="selectedClientAssetRecordRedemption" type="sObject" default="{}"/>
    <aura:attribute name="selectedInstrument" type="sObject" default="{}"/>
    <aura:attribute name="selectedInstrumentSP" type="sObject" default="{}"/>
    <aura:attribute name="artId" type="String" default="{!v.recordId}" access="global" />
    
    <aura:attribute name="primaryFA" type="String" />

    <aura:attribute name="productList" type="String[]" />
    <aura:attribute name="objDetail" type="contact" default="{'sobjectType' : 'Order_Entry__c'}"/>
    <aura:attribute name="controllingFieldAPI" type="string" default="Product_Type_Order_Entry__c" description="store field API name of Controller field"/>
    <aura:attribute name="dependingFieldAPI" type="string" default="Transaction_Type__c" description="store field API name of dependent field"/>
    <aura:attribute name="listControllingValues" type="list" default="[]" description="to store controller field values"/>
    <aura:attribute name="listMarketTypeValues" type="list" default="IPO,Market purchase" description="to store Market Type field values"/>
    <aura:attribute name="listDependingValues" type="list" default="['--- None ---']" description="to store dependent field values"/>
    <aura:attribute name="depnedentFieldMap" type="map" description="map to store dependent values with controlling value"/>
    <aura:attribute name="bDisabledDependentFld" type="boolean" default="true"/> 
    <aura:attribute name="isFirstScreen" type="Boolean" Default ="true" />
    <aura:attribute name="isProuctTypeMF" type="Boolean" Default ="false" />
    <aura:attribute name="isPreviewScreen" type="Boolean" Default ="false" />
    <aura:attribute name="isFetchDetails" type="Boolean" Default ="false" />

    <aura:attribute name="orderDateStr" type="String"/>
    <aura:attribute name="valueDateStr" type="String"/>
    <aura:attribute name="accountNameDisplay" type="String"/>
    <aura:attribute name="isRedemAllUnit" type="Boolean" Default ="false"/>
    <aura:attribute name="isPartialAmount" type="Boolean" Default ="false"/>
    <aura:attribute name="isPartialUnit" type="Boolean" Default ="false"/>
    <aura:attribute name="isPurchaseAmount" type="Boolean" Default ="false"/>
    <aura:attribute name="currentTime" type="DateTime" />
    <aura:attribute name="isDisableTxnAmount" type="Boolean" Default ="true" />
    <aura:attribute name="isDisableRedemptionUnit" type="Boolean" Default ="true" />
    
    <aura:attribute name="columns" type="List"/>

    <aura:attribute name="isPriceDisable" type="Boolean" default="false" />
    <aura:attribute name="mydata" type="DrawdownData.DrawdownDataWrapper[]" />
    
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
   <!-- <aura:handler name="change" value="{!v.orderEntry.Family_Name__c}" action="{!c.familySelection}"/> -->
    <aura:handler name="change" value="{!v.selectedClientRecord}" action="{!c.clientAccountSelection}"/>
    <aura:handler name="change" value="{!v.selectedClientAccountRecord}" action="{!c.getProducts}"/>
 <aura:handler name="change" value="{!v.selectedFamilyRecord}" action="{!c.setValueToFamily}"/>
    
    <aura:handler name="change" value="{!v.selectedAMCName}" action="{!c.getScheme}"/>
	
    <aura:attribute name="isPMS" type="Boolean" Default ="false" />
    <aura:attribute name="showProductName" type="Boolean" Default ="false" />

    <aura:attribute name="isPaymentModeDisable" type="Boolean" Default ="false" />
    <aura:attribute name="isPOADisplay" type="Boolean" Default ="false" />
    <aura:attribute name="isExternalDisplay" type="Boolean" Default ="false" />
    <aura:attribute name="isPOA" type="Boolean" Default ="false" />
    <aura:attribute name="isNonPOA" type="Boolean" Default ="true" />

    <!-- Check for Profile Access -->
    <aura:attribute name="isProfileAccess" type="Boolean" Default ="false" />
    
    <!-- PMS Ends -->
    
    <!-- PE Start -->
    <aura:attribute name="isPE" type="Boolean" Default ="false" />
    <aura:attribute name="showSecurityName" type="Boolean" Default ="false" />
    <aura:handler name="change" value="{!v.selectedSecurityName}" action="{!c.setValueToSecurityName}"/>
    <aura:attribute name="selectedSecurityName" type="sObject" default="{}"/>
    <aura:attribute name="isPECreationDrawdown" type="Boolean" Default ="false" />
    <aura:attribute name="isPEDrawdown" type="Boolean" Default ="false" />
    <aura:attribute name="isPEWithdrawal" type="Boolean" Default ="false" />
    <aura:attribute name="isPECloseout" type="Boolean" Default ="false" />
    <aura:attribute name="isPECreation" type="Boolean" Default ="false" />
    <aura:attribute name="isPECompliance" type="Boolean" Default ="false" />
    <!-- PE Ends-->
    
    <aura:attribute name="tooltip" type="boolean" default="false" />
    <aura:attribute name="tooltip1" type="boolean" default="false" />
    <aura:attribute name="HoldingInformationAPI" type="String[]" />

    <!-- show Modal for SoftCuttoff Time Start -->
    <aura:attribute name="ShowModule" type="boolean" default="false"/> 
    <aura:if isTrue="{!v.ShowModule}">
        <div class="demo-only" style="height: 740px;">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        
                        <lightning:buttonIcon iconName="utility:close" variant="bare" onclick="{! c.HideMe }"
                                              alternativeText="Close" class="slds-modal__close" />
                        
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Soft Cutoff Time</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <p><b>Your order will not be eligible for previous day NAV</b></p>
                    </div>
                    <footer class="slds-modal__footer">                        
                        <lightning:button variant="brand" label="Ok" title="Hide Me" onclick="{! c.okClick }"/>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
        
    </aura:if>  
    
    
    
    <!-- show Modal for SoftCuttoff Time Ends -->
    
    <aura:renderIf isTrue="{!v.isProfileAccess}">
        <!-- Screen 1 for Both MF and Bond and PMS PE-->
        <aura:renderIf isTrue="{!v.isFirstScreen}">
            <div class="demo-only" style="height: 640px;width:100%">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-scrollable">
                    <div class="slds-modal__container" style="max-width: 70% !important;width:70% !important;">
                        <header class="slds-modal__header">
                            <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModel}">
                                X
                                <span class="slds-assistive-text">Close</span></button>
                            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Initiate Transaction</h2>
                        </header>
                        <article class="slds-card">
                            <div class="slds-card__body slds-card__body_inner">
                                <div class="slds-path">
                                    <div class="slds-grid slds-path__track">
                                        <div class="slds-grid slds-path__scroller-container">
                                            <div class="slds-path__scroller" role="application">
                                                <div class="slds-path__scroller_inner">
                                                    <ul class="slds-path__nav" role="listbox" aria-orientation="horizontal">
                                                        <li class="slds-path__item slds-is-current" role="presentation">
                                                            <a  aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-11" role="option" tabindex="-1">
                                                                <span class="slds-path__title "> Initiate Transaction</span>
                                                            </a>
                                                        </li>
                                                        <li class="slds-path__item slds-is-incomplete" role="presentation">
                                                            <a onclick="{!c.loadMainScreen}" aria-selected="false" class="slds-path__link" href="javascript:void(0);" id="path-12" role="option" tabindex="-1">
                                                                <span class="slds-path__stage">
                                                                    
                                                                </span>
                                                                <span class="slds-path__title" >Transaction Details</span>
                                                            </a>
                                                        </li>
                                                        <li class="slds-path__item slds-is-incomplete" role="presentation">
                                                            <a onclick="{!c.setValuesToField}" aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-13" role="option" tabindex="0">
                                                                <span class="slds-path__stage">
                                                                    
                                                                    <span class="slds-assistive-text">Current Stage:</span>
                                                                </span>
                                                                <span class="slds-path__title">Compliance</span>
                                                            </a>
                                                        </li>                
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>       
                                    </div>
                                </div>
                            </div>
                        </article>
                        <!-- Added By Raj -->
                        <div class="slds-scrollable_y slds-grid slds-wrap slds-size_2-of-2 slds-modal__content" style="height:20rem">
                            <div class="slds-col slds-size_1-of-2">
                                <div class="slds-p-around_medium" id="modal-content-id-1" >
                                    <!--lightning help text for input field-->                                                                
                                    <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                    <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Family Name</label>
                                <!-- <force:inputField aura:id="familyName" required="true"  value="{!v.orderEntry.Family_Name__c}" />  -->
                               <c:customLookup objectAPIName="Account" IconName="standard:account" selectedRecord="{!v.selectedFamilyRecord}" listOfFilteredRecords ="{!v.filteredFamilyList}" placeholder="Search Family"  /> 
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-2">
                                
                                <div class="slds-p-around_medium" id="modal-content-id-1" >
                                    <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                    <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Client Name</label>
                                    <c:customLookup objectAPIName="Account" IconName="standard:account" aura:id="clientNameLookup" selectedRecord="{!v.selectedClientRecord}" listOfFilteredRecords ="{!v.filteredClientList}" placeholder="Search Client"  />
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <div class="slds-p-around_medium" id="modal-content-id-1" >
                                    <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                    <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Account Name</label>
                                    <c:customLookup objectAPIName="Client_Account__c" aura:id="clientAccountLookup" IconName="standard:product" selectedRecord="{!v.selectedClientAccountRecord}" listOfFilteredRecords ="{!v.filteredClientAccountList}" placeholder="Search Client Account"  />
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-2 ">
                                <div class=" slds-p-around_medium" id="modal-content-id-1" >
                                    <!--Controller Field-->
                                    <lightning:select name="controllerFld"
                                                      value="{!v.orderEntry.Product_Type_Order_Entry__c}"
                                                      label="Product Type"
                                                      required="true" >
                                        <aura:iteration items="{!v.listControllingValues}" var="val">
                                            <aura:if isTrue ="{!val =='PE / AIF'}" >
                                                <option value="{!val}">{!val}</option>
                                            </aura:if>
                                        </aura:iteration>
                                    </lightning:select>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-2">
                                <!--Dependent Field-->
                                <div class="slds-p-around_medium" id="modal-content-id-1" >
                                    <lightning:select name="dependentFld"
                                                      value="{!v.orderEntry.Transaction_Type__c}"
                                                      label="Transaction Type"
                                                      onchange="{!c.transactionSelection}" 
                                                      disabled="{!v.bDisabledDependentFld}" required="true">
                                        <aura:iteration items="{!v.listDependingValues}" var="val">
                                            <option value="{!val}">{!val}</option>
                                        </aura:iteration>
                                    </lightning:select>
                                </div> 
                                
                            </div>
                            <div class="slds-col slds-size_1-of-1">
                   
                                <aura:renderIf isTrue="{!v.showSecurityName}">                                                                                         
                                    <div class="slds-p-around_medium" id="modal-content-id-1" >
                                        <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                        <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Security Name</label>
                                        <!-- <c:CustomListSearch_Duplicate selectedRecord="{!v.selectedSecurityName}" orderEntry="{!v.orderEntry}" objectName="Product2" fieldName="Name" label="" iconName="standard:account" placeholder="Enter Security Name" widthFlag="100"/> -->
                                        <c:CustomListSearch selectedRecord="{!v.selectedSecurityName}" orderEntry="{!v.orderEntry}" objectName="Product2" fieldName="Name" label="" iconName="standard:account" placeholder="Enter Security Name"/>
                                    </div>
                                </aura:renderIf>
                 
                                <!-- PE Ends -->
                            </div>          
                        </div> 
                        <footer class="slds-modal__footer">	
                            <button class="slds-button slds-button_neutral" onclick="{!c.closeModel}">Cancel</button>
                            <button class="slds-button slds-button_brand" onclick="{!c.loadMainScreen}">Next</button>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:renderIf>
    </aura:renderIf>
    
    <!-- Screen 3 FOR Both MF and BOND ans PMS and SP, PE-->
    <aura:renderIf  isTrue="{!v.isPreviewScreen}">
        <div class="demo-only" style="height: 740px;width:100%">
            <section tabindex="-1" class="slds-modal slds-fade-in-open" role="dialog" aria-describedby="modal-content-id-1" aria-labelledby="modal-heading-01" aria-modal="true">
                <div class="slds-modal__container lightningtoast" style="max-width: 70% !important;width: 70% !important;">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModel}">
                            X
                            <span class="slds-assistive-text">Close</span></button>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Compliance</h2>
                    </header>
                    <article class="slds-card">
                        <div class="slds-card__body slds-card__body_inner">
                            <div class="slds-path">
                                <div class="slds-grid slds-path__track">
                                    <div class="slds-grid slds-path__scroller-container">
                                        <div class="slds-path__scroller" role="application">
                                            <div class="slds-path__scroller_inner">
                                                <ul class="slds-path__nav" role="listbox" aria-orientation="horizontal">
                                                    <li class="slds-path__item slds-is-active slds-is-complete" role="presentation">
                                                        <aura:if isTrue="{! or(v.isPurchase,v.isRedemption)}" >
                                                            <a onclick="{!c.loadFirstScreen}"  aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-11" role="option" tabindex="-1" onmouseover="{!c.showToolTip}" onmouseout="{!c.HideToolTip}">
                                                                <span class="slds-path__title " > 
                                                                    {!v.accountNameDisplay}~{!v.orderEntry.Transaction_Type__c}~{!v.orderEntry.Scheme__c}
                                                                </span> 
                                                            </a>
                                                        </aura:if>
                                                        <aura:if isTrue="{! v.isPECompliance}" >
                                                            <a onclick="{!c.loadFirstScreen}" aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-11" role="option" tabindex="-1" onmouseover="{!c.showToolTip}" onmouseout="{!c.HideToolTip}">
                                                                <span class="slds-path__title " > 
                                                                    {!v.accountNameDisplay}~{!v.orderEntry.Transaction_Type__c}~{!v.orderEntry.Security_Name_Display__c}
                                                                </span> 
                                                            </a>
                                                        </aura:if>                                                        
                                                    </li>
                                                    <aura:if isTrue="{!v.tooltip}" >
                                                        <aura:if isTrue="{! v.isPECompliance}" >
                                                            <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom-left" role="tooltip" id="help" style="position:absolute;top:-50px;left:100px">
                                                                <div class="slds-popover__body"><span>{!v.accountNameDisplay}~{!v.orderEntry.Transaction_Type__c}~{!v.orderEntry.Security_Name_Display__c}</span></div>
                                                            </div>                                                            
                                                        </aura:if>
                                                    </aura:if>
                                                    <li class="slds-path__item slds-is-active slds-is-complete" role="presentation" >
                                                        <a onclick="{!c.getToMain}"  aria-selected="false" class="slds-path__link" href="javascript:void(0);" id="path-12" role="option" tabindex="-1" >
                                                            <span class="slds-path__stage">                                                                
                                                            </span>
                                                            <aura:if isTrue="{!or (v.orderEntry.Transaction_Type__c == 'Withdrawal',v.orderEntry.Transaction_Type__c == 'Log Drawdown')}">
                                                                <span class="slds-path__title">Amount In INR {!v.orderEntry.Transaction_Amount_Financial_Transaction__c} On  {!v.orderDateStr}
                                                                </span>
                                                            </aura:if> 
                                                            <aura:if isTrue="{! v.orderEntry.Transaction_Type__c == 'Creation and Drawdown'}">
                                                                <span class="slds-path__title">Amount In INR {!v.orderEntry.Transaction_Amount_Financial_Transaction__c} On  {!v.orderDateStr}
                                                                </span>
                                                            </aura:if>
                                                            <aura:if isTrue="{! v.orderEntry.Transaction_Type__c == 'Log Commitment'}">
                                                                <span class="slds-path__title">Commitment In INR {!v.orderEntry.Commitment_Amount__c} On  {!v.orderDateStr}
                                                                </span>
                                                            </aura:if>
                                                            <aura:if isTrue="{! v.orderEntry.Transaction_Type__c == 'Close Out'}">
                                                               <span class="slds-path__title">  {!v.orderDateStr}
                                                                </span>
                                                                <!-- PE ID ::  {!v.orderEntry.PE_ID__c} On -->
                                                            </aura:if>
                                                        </a>
                                                    </li>
                                                    
                                                    <li class="slds-path__item slds-is-current" role="presentation">                                                        
                                                        <a onclick="{!c.loadFirstScreen}"  aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-11" role="option" tabindex="-1" onmouseover="{!c.showToolTip1}" onmouseout="{!c.HideToolTip1}">
                                                            <span class="slds-path__title">Client Risk Profile :{!v.orderEntry.Client_Risk_Profile__c } ~ Product Risk Profile:{!v.orderEntry.Product_Risk_Profile_FinancialT__c }
                                                            </span> 
                                                        </a>                                                       
                                                    </li>																										
                                                    <aura:if isTrue="{!v.tooltip1}" >                                                        
                                                        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom-left" role="tooltip" id="help" style="position:absolute;top:-50px;right:10px">
                                                            <div class="slds-popover__body"> <span >Client Risk Profile :{!v.orderEntry.Client_Risk_Profile__c } ~ Product Risk Profile:{!v.orderEntry.Product_Risk_Profile_FinancialT__c }
                                                                </span></div>
                                                        </div>                                                                                                                                                                           
                                                    </aura:if>	
                                                </ul>
                                            </div>
                                        </div>
                                    </div>       
                                </div>
                            </div>
                        </div>
                    </article>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div style="width: 100%;">
                            <div class="slds-form slds-form_compound" style="text-align: left;">
                                <div class="slds-form-element__group">
                                    
                                    
                                    <div class="slds-form-element__row">
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 20px 0px 0px 0px;">                                            
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Client Risk Profile</label>
                                            <lightning:input value="{!v.orderEntry.Client_Risk_Profile__c}" disabled="{!v.isDisabled}"/>
                                        </div>
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 20px 0px 0px 10px;">
                                            <!--  <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>-->
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Product Risk Profile </label>
                                            <lightning:input value="{!v.orderEntry.Product_Risk_Profile_FinancialT__c}" disabled="{!v.isDisabled}"/>
                                        </div>
                                    </div>    
                                    <div class="slds-form-element__row">
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"   style ="padding: 10px 0px 0px 0px;">
                                            <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Primary FA</label>
                                            <lightning:input value="{!v.orderEntry.Primary_FA__c}" disabled="{!v.isDisabled}"/>
                                        </div>
                                    </div>
                                    <div class="slds-form-element__row">                                        
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 10px 0px 0px 0px;">
                                            <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Communication Mode</label>
                                            <div Style=" margin: -11px 0px 0px 0px;">
                                                <force:inputField required="true"  value="{!v.orderEntry.Origin__c}" />
                                            </div>
                                        </div>
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 10px 0px 0px 10px;" >
                                            <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Client Consent</label>
                                            <div Style=" margin: -11px 0px 0px 0px;">
                                                <lightning:input value="{!v.orderEntry.Client_Concent__c}" disabled="{!v.isDisabled}"/>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                    <div class="slds-form-element__row">  
                                        <aura:if isTrue="{! or( v.isPMSCompliance,v.isPECompliance)}" >
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 20px 0px 0px 0px; padding-top: 25px;">                                           
                                                <lightning:input required="true" aura:id="fileUpload" onchange="{!c.handleFilesChange}" label="Client Consent  Attachment" type="file" name="file" multiple="false"/>
                                                <div class="slds-text-body_small slds-text-color_error">{!v.fileName} </div>
                                                
                                                <!--use aura:if for show-hide the loading spinner image--> 
                                                <aura:if isTrue="{!v.showLoadingSpinner}">
                                                    <div class="slds-text-body_small slds-text-color_error">Uploading... 
                                                        <img src="/auraFW/resources/aura/images/spinner.gif" class="spinner-img" alt="Loading"/>'
                                                    </div>
                                                </aura:if>
                                                <br/>                                            
                                            </div>
                                        </aura:if>
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style ="padding: 10px 0px 0px 0px;">
                                            
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick="{!c.closeModel}" >Cancel</button>
                        <button class="slds-button slds-button_brand" onclick="{!c.getToMain}" >Back</button>                        
                        <button class="slds-button slds-button_brand" onclick="{!c.SaveRecord}" >Save for Preview</button>                       
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
    </aura:renderIf>
    
    <!-- Transaction Screen for PE Start-->
    <aura:renderIf  isTrue="{! v.isPE}">
        <div class="demo-only" style="height: 740px;width:100%">
            <section tabindex="-1" class="slds-modal slds-fade-in-open" role="dialog" aria-describedby="modal-content-id-1" aria-labelledby="modal-heading-01" aria-modal="true">
                <div class="slds-modal__container lightningtoast" style="max-width: 70% !important;width: 70% !important;">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModel}">
                            X
                            <span class="slds-assistive-text">Close</span></button>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Transaction Details</h2>
                    </header>
                    <article class="slds-card">
                        <div class="slds-card__body slds-card__body_inner">
                            <div class="slds-path">
                                <div class="slds-grid slds-path__track">
                                    <div class="slds-grid slds-path__scroller-container">
                                        <div class="slds-path__scroller" role="application">
                                            <div class="slds-path__scroller_inner">
                                                <ul class="slds-path__nav" role="listbox" aria-orientation="horizontal">
                                                    <li class="slds-path__item slds-is-active slds-is-complete" role="presentation">
                                                        <aura:if isTrue="{!v.isPE}" >
                                                            <a onclick="{!c.loadFirstScreen}" aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-11" role="option" tabindex="-1" onmouseover="{!c.showToolTip}" onmouseout="{!c.HideToolTip}">
                                                                <span class="slds-path__title " > 
                                                                    {!v.accountNameDisplay}~{!v.orderEntry.Transaction_Type__c}~{!v.orderEntry.Security_Name_Display__c}
                                                                </span> 
                                                            </a>
                                                        </aura:if>                                                        
                                                    </li>
                                                    <aura:if isTrue="{!v.tooltip}" >
                                                        <aura:if isTrue="{! v.isPE}" >
                                                            <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom-left" role="tooltip" id="help" style="position:absolute;top:-50px;left:100px">
                                                                <div class="slds-popover__body"><span>{!v.accountNameDisplay}~{!v.orderEntry.Transaction_Type__c}~{!v.orderEntry.Security_Name_Display__c}</span></div>
                                                            </div>
                                                        </aura:if>                                                        
                                                    </aura:if>
                                                    
                                                    <li class="slds-path__item slds-is-current" role="presentation">
                                                        <a aria-selected="false" class="slds-path__link" href="javascript:void(0);" id="path-12" role="option" tabindex="-1">
                                                            <span class="slds-path__stage">
                                                                
                                                            </span>
                                                            <span class="slds-path__title">Transaction Details</span>
                                                        </a>
                                                    </li>
                                                    <li class="slds-path__item slds-is-incomplete" role="presentation">
                                                        <a  onclick="{!c.setValuesToPEField}"  aria-selected="true" class="slds-path__link" href="javascript:void(0);" id="path-13" role="option" tabindex="0">
                                                            <span class="slds-path__stage">
                                                                
                                                                <span class="slds-assistive-text">Current Stage:</span>
                                                            </span>
                                                            <span class="slds-path__title">Compliance</span>
                                                        </a>
                                                    </li>                
                                                </ul>
                                            </div>
                                        </div>
                                    </div>       
                                </div>
                            </div>
                        </div>
                    </article>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div style="width: 100%;">
                            <div class="slds-form slds-form_compound" style="text-align: left;">
                                <div class="slds-form-element__group">                                                                                                            
                                    <div class="slds-form-element__row">
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style="padding-top: 10px">
                                            <img src="{! $Resource.IPSMandatoryIcon}" height="12" width="12"/>
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Order Date</label>
                                            <div style="margin-top: -10px;">
                                                <lightning:input aura:id="orderDate"   value="{!v.orderDateStr}" disabled="{!v.isDisabled}"/>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style="padding-top: 10px">
                                            <img src="{! $Resource.IPSMandatoryIcon}" height="12" width="12"/>
                                            <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Value Date</label>
                                            <div style="margin-top: -10px;">
                                                <lightning:input aura:id="orderDate"  value="{!v.valueDateStr}" disabled="{!v.isDisabled}"/>
                                            </div>
                                        </div>
                                        
                                    </div> 
                                    <div class="slds-form-element__row">                                                                                                                           
                                        <aura:renderIf  isTrue="{!or (v.orderEntry.Transaction_Type__c == 'Log Commitment',v.orderEntry.Transaction_Type__c == 'Creation and Drawdown')}">
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style="padding-top: 10px">
                                                <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                                <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Commitment Amount</label>
                                                <div style="margin-top:7px;">
                                                    <!--	<force:inputField required="true"  value="{!v.orderEntry.Commitment_Amount__c}"/> -->
                                                    <ui:inputNumber required="true"  value="{!v.orderEntry.Commitment_Amount__c}" />
                                                </div>
                                            </div>
                                        </aura:renderIf>
                                        <aura:renderIf isTrue="{!or (v.orderEntry.Transaction_Type__c == 'Log Drawdown',v.orderEntry.Transaction_Type__c == 'Withdrawal')}">
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style="padding-top: 10px" >
                                                <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13"/>
                                                <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Transaction Amount </label>
                                                <div style="margin-top: 7px;">
                                                    <ui:inputNumber required="true"  value="{!v.orderEntry.Transaction_Amount_Financial_Transaction__c}" />
                                                    <!--<force:inputField required="true"  value="{!v.orderEntry.Transaction_Amount_Financial_Transaction__c}"/> -->
                                                </div>
                                            </div> 
                                        </aura:renderIf>                                        
                                    </div>                                                                      
                                    <div class="slds-form-element__row">
                                        <aura:renderIf isTrue="{!or (v.orderEntry.Transaction_Type__c == 'Creation and Drawdown',v.orderEntry.Transaction_Type__c == 'Close Out')}">
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style="padding-top: 10px">
                                                <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13" />
                                                <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Payment Mode</label>
                                                <div style="margin-top:-13px;">
                                                    <force:inputField  required="true"  value="{!v.orderEntry.Payment_Mode__c}"/>
                                                </div>
                                            </div> 
                                        </aura:renderIf>
                                        <aura:renderIf  isTrue="{!or (v.orderEntry.Transaction_Type__c == 'Log Drawdown',v.orderEntry.Transaction_Type__c == 'Withdrawal')}">                                        
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2" style="padding-top: 10px">
                                                <img src="{! $Resource.IPSMandatoryIcon}" height="13" width="13" />
                                                <label class="slds-form-element__label" for="textareaSample2" style="display: inline;" >Payment Mode</label>
                                                <div style="margin-top:-13px;">
                                                    <force:inputField  required="true"  value="{!v.orderEntry.Payment_Mode__c}"/>
                                                </div>
                                            </div>  
                                        </aura:renderIf>  
                                        
                                        <aura:renderIf  isTrue="{!v.orderEntry.Transaction_Type__c == 'Log Drawdown'}">   
                                            <div class="slds-form-element slds-wrap slds-col slds-size_1-of-2"  style ="padding: 32px 0px 0px 10px;"> 
                                                <button class="slds-button slds-button_brand" onclick="{!c.fetchDrawdownDetails}" >Fetch drawdown details </button>
                                            </div>
                                        </aura:renderIf> 
                                        
                                        
                                    </div>
                                    <br/>
                                    <aura:renderIf  isTrue="{!v.orderEntry.Transaction_Type__c == 'Log Drawdown'}">                                        
                                        <aura:renderIf isTrue="{!v.isFetchDetails}">
                                            <div style="height: 100px">
                                               
                                                <table class= "slds-table slds-table_cell-buffer slds-table_bordered">    	
                                                    <thead>
                                                        <tr class="slds-text-heading-label">             	
                                                            <aura:iteration items="{!v.columns}" var="col">                     
                                                                <th > {!col.label} </th>  
                                                            </aura:iteration>                
                                                        </tr>        	 
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.mydata}" var="con">
                                                             <tr>
            <th scope="row">
              <div class="slds-truncate" title="{!con.drawDownDueDate}">{!con.drawDownDueDate}</div>
            </th>
            <th scope="row">
              <div class="slds-truncate" title="{!con.drawDownAmtStr}">{!con.drawDownAmtStr}</div>
            </th>
            <th scope="row">
              <div class="slds-truncate" title="{!con.drawDownAmtPaidTillDateStr}">{!con.drawDownAmtPaidTillDateStr}</div>
            </th>
            <th scope="row">
               <div class="slds-truncate" title="{!con.drawDownAmtDueStr}">{!con.drawDownAmtDueStr}</div>
            </th>
          </tr>
                                                        </aura:iteration>              
                                                    </tbody>    
                                                </table>
                                            </div>
                                        </aura:renderIf>
                                    </aura:renderIf>
                                    
                                    
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick="{!c.closeModel}" >Cancel</button>
                        <button class="slds-button slds-button_brand" onclick="{!c.loadFirstScreen}" >Back</button>
                        <button class="slds-button slds-button_brand" onclick="{!c.setValuesToPEField}" >Next</button>
                        
                        
                        <!--<button class="slds-button slds-button_brand" onclick="{!c.saveAnswer}" >Save</button>-->
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
        
    </aura:renderIf>
</aura:component>